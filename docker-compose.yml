version: "3.4"

services:
  spreadsheet-server:
    container_name: spreadsheet-server
    build: . # Uses local Dockerfile
    environment:
      SYNCFUSION_LICENSE_KEY: ${SYNCFUSION_LICENSE_KEY}
      LC_ALL: de_DE.UTF-8
      LANGUAGE: de_DE.UTF-8
      LANG: de_DE.UTF-8
    # Removed port exposure - now internal only
    networks:
      - spreadsheet-network

  nginx:
    image: docker.io/library/nginx:latest
    container_name: nginx
    ports:
      - "8080:80"
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
    restart: unless-stopped
    depends_on:
      - spreadsheet-server

  # Add a shared network for internal communication
  networks:
    - spreadsheet-network

networks:
  spreadsheet-network:
    driver: bridge
